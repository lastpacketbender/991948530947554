# pklmx2eeh6fjt7zf.onion

After completing [`the second onion's ping/pong puzzle`](../005-second-onion/README.md#icmpping-puzzle), users navigated to `pklmx2eeh6fjt7zf.onion`.

## Standby for coordinates

The initial state of the website was a PGP signed messaged to standby for coordinates. See [standby.html](standby.html).

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1


Standby for coordinates.

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)

iQIcBAEBAgAGBQJQ8J48AAoJEBgfAeV6NQkPfIAP+wdCz/4fw6SHZrFMonpOTwwN
K93vi1/E/o0Vw1sEZXtCPgtbetZXVfCZ/CSU3Gez1l1Q2Yr6VSBZtPZswyDETSvU
1ObpYpaL//fUcOtIiL4EH4YZeyvYz2OoegIBsw6ydLr2HqyEO2Qf5zobSjG1sMDI
yLlv5xvIRx1RCma/5R4cJeOwzMVtVblMOHS2q7wLMZ0+l7+twun7HsNWbSGW74wX
WrOpZCrFg6n/sZEwRVo2m8RRjnhGRR7pQoJrG+yMB6HKsLFHYp0M5HBR+xiBy6mH
6naisMeEpbl18dWyZhMrtKejaMgOb8SCskJKW9dnb0m+1MPZVZUsosSw/QTA+NeZ
S/CcJFwmwEp5vRsPdlXlFWX6ZEXxxPo9L4HESlAyTLOWKk0n3LemV8vaUgS2GA6n
EBAuRjo70hqHKWI9URo/LyvMAmde9d4Aq8oKtfKN9wyt1f4+T9H84fyRNd6LLd8x
5ohtTpWiusvtvx4zCiizMPaJuQG63R4eANVcEAExloWeXtea3AJpK/yuRIolZRPJ
bpFIAtXQEpTe/xo1QzNSOL7sSn/iZpSFpKgma1skn3yrRczEO608NasWFUUdBEeQ
iw/GMKT0owqw9Xfar/YL1FgB7a85U7ESHlyZKukQ7VdiBuVLLkt3k8mKT4cB+bXV
doY/8ImgRud+X06gxLjJ
=sQDQ
-----END PGP SIGNATURE-----
```

## Coordinates

The onion began updating with coordinates, here are a few I've been able to find.

See [okinawa.html](okinawa.html) for the website with this update.

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

38.977845, -76.486451
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)

iQIcBAEBAgAGBQJQ8cuvAAoJEBgfAeV6NQkPzjYQAJRGr5ovfviw3vw1DN/M91t2
xinXxaGIhBWUIsKixiaGfafVcY2cAmpDYfADmZMFn1K7K6cgZkMY1UQxyjVS4w0l
wBP0yNODfRnFIXpBqfeGiby+eI97p8aB/HfAfIXdDeDWVaeGITnd5G/2tBy3+TO6
/sYNtFLTVg3HmkwjSK9oYbIGBWNzD0IAO+5zWBYp756H6AQiQlre5IGV4LYRoiNK
fB95hekOVgOSqppmAjSydFd30RqOec/hY/VeSBASf25lmiFxMJKakuNxkK0CHj3I
cQsiRUxUsVSrVzeQHlD4X05+4pvRiwCnVa9oGRyaLbD0ySPfoCFPIbqwZj+zEV42
l6Izyn11wnYRKQTtcTKSM1Kk5yJ8y5lwiGhby5lHzfNiet2hnLtY56JI/dqjqfO1
QVtwo+KUGMq57yKKoCx3lrw71N3igHfiWO41GyiHxaibWupF2h7WVL5NDifx1LhS
ZR1GJVzyY1Lsj3V5NbidLgg9me+pHKuv727Pc+X1SqEve/2IYuHcI2M3eJ2LbHAq
sVuZvdZUhNbIfN26ePgMhUCbL/U6RqLSKW1yfZzqfnC76XKBPFoPT9qJdn0Xhzzd
PuJi7TXI15ejz/GO3BFHP05KaodEWIVeqHYKNQ0rf5JtJw3zL2QED8v5YBJ+P/ow
DO6Q1iuhv4YkcxuF23wD
=7qF2
-----END PGP SIGNATURE-----
```

See [annapolis.html](annapolis.html) for the website with this update.

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

26.41968, 127.73254
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)

iQIcBAEBAgAGBQJQ8coXAAoJEBgfAeV6NQkPx5EQAI2OmC0nikY26ZQu2/Y0czUa
Se3VxcE2YnsfLAQajsw3fRmv3BcCSL8u41IvQidAY12OKr8QSMDoR8C5fVSC+4ms
rcp6dQHkLgE03TPvFxaquhiI1j+HXcult+7IM44WttuMQAuQf8cwIMUehWKnn/eu
g9j4nfL5kWM2uaFvQitwm3e+dbA7OJWGIqm1jgGsM9w7SORQiRT7tNy1bi7dw0u6
wEthNkA9VJCY3u7qFrQGE2UWCknFGvkAe5QzSTMrSuPUykbQQWwlou8oN7SrLbMo
Sl6EUnytmmRT6mlg481J6InyNb4EP2SFcJ06L2Dm1rwDEBpPv6BIBhSdqjiMBbA7
/zyXw7jjV8DqQPsMqNjzVgoVfoywQ+EUyFPbKxQDWZ9hyeOxJKrm5+47NDIGN3eP
Hrl2GqbOxfoQ31Avzgik4UDCqPazk9RgRfed7xki1LAK5a8EJ9PrNU5vqGhNUx7g
hwOBdYpYTKbMbEr86N4ySw5oObo/YM+/3h5U8kXyDEt3YW1zp5YQYP0M8f80/3QT
ZuMm6Jwtqhr91eBq8Jq1CunkUGqMezT+etaaD3lXhbXeBP4nyrZYNYN6qvSOFRa3
kxzUK5eUm9sepaW1x/xHEvDLq1nzx4EJguZvy1ypDxDzI7BlHsDtc7U7lfce1yhE
hn2rK0XiDXd0A6sK2tgu
=U6r6
-----END PGP SIGNATURE-----
```

6 of the locations had their codes recovered, while the seventh was not physically visited. The phone number was obtained by wardialing all numbers ending in 1033. 

![okinawa.jpg](posters/okinawa.jpg)
![moscow](posters/moscow.jpg)
![arkansas.jpg](posters/arkansas.jpg)
![oregon.jpg](posters/oregon.jpg)
![georgia.jpg](posters/georgia.jpg)

### Phone numbers

Upon calling the phone number an IVR asked for a code to be typed into the dialer. The code wasn't T9, the solvers had to convert the access code to its gemtria value. After successfully authenticating, a message in the format of the following was given.

Each message was unique.

The dataset is in reference to the extension of the file in the [OS](../002-3301/README.md#data)'s data folder.

```
Dataset: 13
Offset: 12821
Data: 28C07E1B102D4D5C4C1A376E064477E1416FCC94928765
```

To decrypt the data, follow exactly as directed. Seek to offset `12821` in [560.13](../002-3301/3301-contents/data/560.13), decode the hex to binary, and xor the bytes at that section of the file with the decoded binary resulting in an onion address.

See [xor.py](./xor.py) for decoding details.

This gives us `gbyh7znm6c7ezsmr.onion`.

### All locations, codes, and onions

See [xor-all.py](./xor-all.py) to decrypt all phone messages as they are recorded at the time of writing this. All but one give
a valid decrypt.

```
17:33461:f6a2d0a48e1b1ae40cbd454f77baa7d2557683d0cd4998
y2wyuvrqraowagc5.onion

13:37861:f286b8438cb85eb191ec7bf10a28a54ec06f9a27eb91c5
wzwmcwmsk5cb7gjn.onion

13:1111111:c657b2707c4266fda4af4a83acf19cc46e69540c0bc5da
qw7mhchzvuq6f2mf.onion

13:13831:5edb5e8029dd2182560da925ec6cd3e1257efc0b8328b4
4l6uipnstbggwjyv.onion

17:77977:d5a6cb76e55a2166bd6a4d78857ec1f68ea6afa97380
erwfcsdvx6p?[^È#«:Ö
13:12821:28c07e1b102d4d5c4c1a376e064477e1416fcc94928765
gbyh7znm6c7ezsmr.onion

17:617:d4b10626d65995e8fb010f4388787d56433f90c6df8d8d
ll5afyskb6v6g7ga.onion
```

Each onion address distributed a Shamir's Secret Sharing Scheme SSSS code. It is a scheme that allows reconstruction of a secret when from X number of recovered shares, called the threshold - then shares can be combined to result in the secret.

The known locations:

|Location |	Coordinates |Image |	Phone # |Access code |Message file / offset |	Message |Onion | SSSS|
|---|---|---|---|---|---|---|---|---|
|Dallas TX |	33.092817, -96.08265 	||	+1 205-396-3301 |	JD: 3789 	|17, offset 33461 |	f6a2d0a48e1b1ae40cbd454f77baa7d2557683d0cd4998 |	y2wyuvrqraowagc5.onion |	02-41cc481a51fe77f91600f593c1db2ce9babd2626ea6e
Okinawa Japan |	26.41968, 127.73254 |	[okinawa.jpg](posters/okinawa.jpg) |	+1 626-586-1033 |	YF: 1032 |	13, offset 37861 	|f286b8438cb85eb191ec7bf10a28a54ec06f9a27eb91c5 | 	wzwmcwmsk5cb7gjn.onion |	03-7678a5f6b72042d839151b34b02ffe161cf997fed484
Moscow, Russia |	55.793765, 37.578608 |	[moscow](posters/moscow.jpg) |	+1 928-237-3301 |	CR: 1311 |	13, offset 1111111 	|c657b2707c4266fda4af4a83acf19cc46e69540c0bc5da |	qw7mhchzvuq6f2mf.onion |	05-fcd82965b6632ea25d80edc3e58baafb4b2938895cbd
Little Rock, AR |	34.7477910, -92.2690863 |	[arkansas.jpg](posters/arkansas.jpg) 	|+1 719-428-3301 |	LM: 7167 |	13, offset 13831 	|5edb5e8029dd2182560da925ec6cd3e1257efc0b8328b4 |	4l6uipnstbggwjyv.onion |	07-f3adb3aacb0b4336fa28178bc1e5edce940c16ce5caa
Annapolis, MD* |	38.977845, -76.486451 |	*was not physically recovered |	+1 253-655-1033 |	PX: 4347 |	17, offset 77977 |	d5a6cb76e55a2166bd6a4d78857ec1f68ea6afa9738 |	erwfcsdvx6pm2rsk.onion |	08-b970e507dbc4ac115a273126f62671654c480fce32e5
Portland, OR |	45.50092, -122.652512 |	[oregon.jpg](posters/oregon.jpg) |	+1 424-999-1033  |	GH: 1723 |	13, offset 12821 	|28c07e1b102d4d5c4c1a376e064477e1416fcc94928765 |	gbyh7znm6c7ezsmr.onion |	09-82a98a7fe06014f783b752506cf6cd1fabaa3d8b3750
Columbus, GA |	32.478944, -84.983674 |	[georgia.jpg](posters/georgia.jpg) |	+1 469-251-1033 |	NR: 2911 |	17, offset 617 | 	d4b10626d65995e8fb010f4388787d56433f90c6df8d8d 	|ll5afyskb6v6g7ga.onion 	| 10-1668a611ba9fccddee2a0d8fd7e05df4d01c6d42a26d 

### SSSS reconstruction

You can reconstruct the shares one of two ways.

1. Write your own implementation
2. Take the hint from the way they are formatted and use the program that created them. It is called `ssss`.

The threshold needed was 5 shares. See [reconstruct.sh](reconstruct.sh)

```
$ ssss-combine -t 5 -r < shares.txt
Share [1/5]: Share [2/5]: Share [3/5]: Share [4/5]: Share [5/5]: Resulting secret: p7amjopgric7dfdi.onion
```